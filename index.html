<!DOCTYPE html>
<html>
    <head>
        <title>Input Model</title>
        <link rel="stylesheet" href ="index.css">
    </head>
    <body>

        <div id ="content">
            <h3 id = "subTitle">Input Model</h3>
            <p id = "explanation">Create and train your model in https://ml-machine.org/. Save your model and then drag and drop your file into the box here.</p>
            <p id ="testButton1" onclick = "tryAddBlock()">Test Button</p>
        </div>
        <div id = "fileInputSpace" >
                <p id = "inputHereMes">Drag and drop files here</p>
                <p id = "inputFileMes">Empty</p>
        </div>
    </body>
    <script>
        let dropEl = document.getElementById("fileInputSpace");
        var extId = window.location.hash.substr(1);
        var msg = {
                id: Math.random().toString(),
                type: "pxtpkgext",
                action: "extwritecode",
                extId: extId,
                response: "true",
                body: {
                    code: "main.ts",
                    json: "pxt.json"
                }
            }

        function tryAddBlock(){
            console.log("Try add block entered")
            //trying for communication between editor and extension 
            var msg = {
                id: Math.random().toString(),
                type: "pxtpkgext",
                action: "extwritecode",
                extId: extId,
                response: "true",
                body: {
                    code: "main.ts",
                    json: "pxt.json"
                }
            }

        }

//will probably need to add checks to make sure that the file is in the format that is it supposed to be 
        dropEl.addEventListener("drop", event => {
            let file = event.dataTransfer.files[0];
            document.getElementById("inputFileMes").textContent = file.name;
            console.log(file);
            console.log(file.size);
            reader = new FileReader()
            reader.onload = function(event){
                console.log(reader.result);
            }
            reader.readAsText(file)
            
        });

        ["drag", "dragstart", "dragend", "dragover", "dragenter", "dragleave", "drop"].forEach(eventName => {
            dropEl.addEventListener(eventName, event => {
                event.preventDefault();
                event.stopPropagation();
            });
        });

        ["dragover", "dragenter"].forEach(eventName => {
            dropEl.addEventListener(eventName, event => {
                dropEl.classList.add("hover");
            });
        });

        ["dragleave", "dragend", "drop"].forEach(eventName => {
            dropEl.addEventListener(eventName, event => {
                dropEl.classList.remove("hover");
            });
        });

    </script>
</html>
